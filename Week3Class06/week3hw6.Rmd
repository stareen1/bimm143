---
title: "Week3 HW6"
author: "Sarah Tareen"
date: "2023-04-25"
output: html_document
---

## Section 1: Improving analysis code by writing functions

> A Improve this regular R code by abstracting the main activities in your own new
function. Note, we will go through this example together in the formal lecture. The main
steps should entail running through the code to see if it works, simplifying to a core
working code snippet, reducing any calculation duplication, and finally transferring your
new streamlined code into a more useful function for you.

```{r}
# (A. Can you improve this analysis code?
df <- data.frame(a=1:10, b=seq(200,400,length=10),c=11:20,d=NA)

df$a <- (df$a - min(df$a)) / (max(df$a) - min(df$a))

df$b <- (df$b - min(df$a)) / (max(df$b) - min(df$b))

df$c <- (df$c - min(df$c)) / (max(df$c) - min(df$c))

df$d <- (df$d - min(df$d)) / (max(df$a) - min(df$d))
```

There are some copy paste errors that we need to fix:
```{r}
df <- data.frame(a=1:10, b=seq(200,400,length=10),c=11:20,d=NA)

df$a <- (df$a - min(df$a)) / (max(df$a) - min(df$a))

df$b <- (df$b - min(df$b)) / (max(df$b) - min(df$b))

df$c <- (df$c - min(df$c)) / (max(df$c) - min(df$c))

df$d <- (df$d - min(df$d)) / (max(df$d) - min(df$d))
```

In order to write a function, the first step is to write a working code snippet. We can simplify the code to work with a generic vector. 
```{r}
x <- 1:10
result <- (x - min(x)) / (max(x) - min(x))
result
```

Since we call the `min()` function twice, we can make this more efficient by calling `range()` one time. 
```{r}
rng <- range(x)
result <- (x - rng[1] / (rng[2] - rng[1]))
result
```
Since the code snippet works, we can turn it into a function.
```{r}
rescale <- function(x) {
  rng <- range(x)
  (x - rng[1]) / (rng[2] - rng[1])
}

## Test the function on a small vector.
x <- 1:10
rescale(x)
```
Now we need to improve this function so it works with NA elements. 
```{r}
rescale <- function(x) {
  rng <- range(x, na.rm=TRUE)
  (x - rng[1]) / (rng[2] - rng[1])
}

## Test the function on a small vector.
y <- c(1, 2, NA, 4, 5)
rescale(y)
```

>B Next improve the below example code for the analysis of protein drug interactions by
abstracting the main activities in your own new function. Then answer questions 1 to 6
below. It is recommended that you start a new Project in RStudio in a new directory and
then install the bio3d package noted in the R code below (N.B. you can use the
command install.packages("bio3d") or the RStudio interface to do this).
Then run through the code to see if it works, fix any copy/paste errors before simplifying
to a core working code snippet, reducing any calculation duplication, and finally
transferring it into a more useful function for you.

 > Q1 What type of object is returned from the read.pdb() function? 
 The type of object returned is a pdb object.
 
 > Q2 What does the trim.pdb() function do?
 The trim.pdb() function creates a new PDB object based on the selection of atoms given in the arguments. 
 
 > Q3 What input parameter would turn off the marginal black and grey rectangles in the
plots and what do they represent in this case?
 The input parameter sse would turn off the marginal black and grey rectangles. In this case, it represents which residues have chain A.
 
 > Q4 What would be a better plot to compare across the different proteins?
 A better plot could be a scatterplot of the different proteins that has smooth lines so its easier to compare them side by side. 
 
 > Q5 Which proteins are more similar to each other in their B-factor trends. How could
you quantify this? HINT: try the rbind(), dist() and hclust() functions together with a
resulting dendrogram plot. Look up the documentation to see what each of these functions does.
 - rbind() combines data structured by columns or rows. 
 - dist() find the distances between the rows of a data matrix
 - hclust() makes a dendrogram plot of the dissimilarities 
 
```{r}
hc <- hclust( dist( rbind(s1.b, s2.b, s3.b) ) )
plot(hc)
```

Since s2.b and s3.b are more closely related then the proteins "1AKE" and "1E4Y" are more related to each other. 
 
